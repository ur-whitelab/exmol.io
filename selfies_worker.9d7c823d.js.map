{"mappings":"0xCAAAA,cAAc,4DAEd,IAGMC,EAAa,CACfC,QAAS,SAAAC,GAAO,OAAO,MACvBC,QAAS,SAAAD,GAAO,OAAO,MACvBE,cAAe,UACfC,cAAe,WAGnBC,UAAY,SAACC,GACT,IAAMC,EAAOD,EAAEC,KACTC,EAAQD,EAAK,GACbE,EAAMF,EAAK,GACbG,EAAS,GACC,mBAAVF,EACAE,EAAS,CAAEC,QAASZ,EAAWI,cAAeS,QAASb,EAAWK,eACjD,YAAVI,EACPE,EAASX,EAAWG,QAAQK,EAAK,IAChB,YAAVC,IACPE,EAASX,EAAWC,QAAQO,EAAK,KAErCM,YAAY,CAACL,EAAOC,EAAKC,KAI7BZ,cAAc,4DAEdgB,YAAY,CAAEC,SAAU,mDAAoDC,MAAK,SAACC,GAC9ElB,EAAWI,cAAgB,SAC3Bc,EAAQC,YAAY,YAAYF,MAAK,WACjCC,EAAQE,eAAgB,+EAE8BC,OAjCvC,EAiCuC,mEAEnD,SAACC,GACAtB,EAAWI,cAAgB,SAC3BJ,EAAWK,cAAgB,YAC5BY,MAAK,WACJjB,EAAWK,cAAgB,SAC3B,IAAMJ,EAAUiB,EAAQK,QAAQC,IAAI,WACpCxB,EAAWC,QAAU,SAACY,GAClB,IAEI,OADaZ,EAAQY,GAEvB,MAAON,GAEL,OADAkB,QAAQC,IAAInB,GACL,OAGf,IAAMJ,EAAUe,EAAQK,QAAQC,IAAI,WACpCxB,EAAWG,QAAU,SAACU,GAClB,IAEI,OADaV,EAAQU,GAEvB,MAAON,GAEL,OADAkB,QAAQC,IAAInB,GACL,aAIpB,SAACe,GACAtB,EAAWK,cAAgB","sources":["src/components/lib/selfies/selfies_worker.js"],"sourcesContent":["importScripts('https://cdn.jsdelivr.net/pyodide/v0.20.0/full/pyodide.js');\n\nconst selfiesVersion = 2.0;\nlet pyodide = null;\n// make fake function to start with\nconst selfiesMod = {\n    decoder: s => { return null },\n    encoder: s => { return null },\n    pyodideLoaded: 'loading',\n    selfiesLoaded: 'loading'\n};\n\nonmessage = (e) => {\n    const data = e.data;\n    const mtype = data[0];\n    const mid = data[1];\n    let result = '';\n    if (mtype === 'loading-status') {\n        result = { pyodide: selfiesMod.pyodideLoaded, selfies: selfiesMod.selfiesLoaded };\n    } else if (mtype === 'encoder') {\n        result = selfiesMod.encoder(data[2]);\n    } else if (mtype === 'decoder') {\n        result = selfiesMod.decoder(data[2]);\n    }\n    postMessage([mtype, mid, result]);\n}\n\n\nimportScripts('https://cdn.jsdelivr.net/pyodide/v0.18.1/full/pyodide.js')\n\nloadPyodide({ indexURL: \"https://cdn.jsdelivr.net/pyodide/v0.18.1/full/\" }).then((pyodide) => {\n    selfiesMod.pyodideLoaded = 'loaded';\n    pyodide.loadPackage('micropip').then(() => {\n        pyodide.runPythonAsync(`\n            import micropip\n            await micropip.install('selfies==${selfiesVersion}')\n            from selfies import encoder, decoder\n        `, (err) => {\n            selfiesMod.pyodideLoaded = 'failed';\n            selfiesMod.selfiesLoaded = 'failed';\n        }).then(() => {\n            selfiesMod.selfiesLoaded = 'loaded'\n            const decoder = pyodide.globals.get('decoder');\n            selfiesMod.decoder = (selfies) => {\n                try {\n                    let result = decoder(selfies);\n                    return result;\n                } catch (e) {\n                    console.log(e);\n                    return null;\n                }\n            };\n            const encoder = pyodide.globals.get('encoder');\n            selfiesMod.encoder = (selfies) => {\n                try {\n                    let result = encoder(selfies);\n                    return result;\n                } catch (e) {\n                    console.log(e);\n                    return null;\n                }\n            };\n        });\n    }, (err) => {\n        selfiesMod.selfiesLoaded = 'failed';\n    })\n});\n"],"names":["importScripts","selfiesMod","decoder","s","encoder","pyodideLoaded","selfiesLoaded","onmessage","e","data","mtype","mid","result","pyodide","selfies","postMessage","loadPyodide","indexURL","then","pyodide1","loadPackage","runPythonAsync","concat","err","globals","get","console","log"],"version":3,"file":"selfies_worker.9d7c823d.js.map"}